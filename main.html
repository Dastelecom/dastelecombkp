<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="/manifest.php">
  <meta name="theme-color" content="#ffffff">
  <link rel="dns-prefetch" href="https://cdn.tailwindcss.com">
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preload" as="image" href="security-icon.jpg">
  <link rel="preload" as="image" href="invoice.png">
  <link rel="prefetch" href="select-invoice.html">
  
  <title>Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: transparent;
      overflow-x: hidden;
      /* Improve rendering performance */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    .glow-effect-blue {
      filter: drop-shadow(0 0 15px rgba(59, 130, 246, 0.8))
             drop-shadow(0 0 25px rgba(59, 130, 246, 0.6))
             drop-shadow(0 0 35px rgba(96, 165, 250, 0.5))
             drop-shadow(0 0 45px rgba(147, 197, 253, 0.3));
      transition: filter 0.4s ease;
      animation: pulse 2s infinite;
      will-change: filter;
    }
    .glow-effect-blue:hover {
      filter: drop-shadow(0 0 20px rgba(59, 130, 246, 1))
             drop-shadow(0 0 35px rgba(59, 130, 246, 0.8))
             drop-shadow(0 0 50px rgba(96, 165, 250, 0.6))
             drop-shadow(0 0 65px rgba(147, 197, 253, 0.4));
    }
    .glow-effect-green {
      filter: drop-shadow(0 0 8px rgba(74, 222, 128, 0.5));
      transition: filter 0.3s ease;
      will-change: filter;
    }
    .glow-effect-green:hover {
      filter: drop-shadow(0 0 12px rgba(74, 222, 128, 0.7));
    }
    .glow-effect-cyan {
      filter: drop-shadow(0 0 8px rgba(0, 188, 255, 0.5));
      transition: filter 0.3s ease;
      /* Add hardware acceleration */
      will-change: filter;
    }
    .glow-effect-cyan:hover {
      filter: drop-shadow(0 0 12px rgba(0, 188, 255, 0.7));
    }
    .glow-effect-purple {
      filter: drop-shadow(0 0 8px rgba(167, 139, 250, 0.5));
      transition: filter 0.3s ease;
      will-change: filter;
    }
    .glow-effect-purple:hover {
      filter: drop-shadow(0 0 12px rgba(167, 139, 250, 0.7));
    }
    .card-glow-blue {
      box-shadow: 0 0 25px rgba(59, 130, 246, 0.5),
                 0 0 40px rgba(96, 165, 250, 0.3),
                 0 0 60px rgba(147, 197, 253, 0.2);
      transition: all 0.4s ease;
      animation: cardPulse 2s infinite;
      /* Add hardware acceleration */
      will-change: box-shadow, transform;
    }
    .card-glow-blue:hover {
      box-shadow: 0 0 35px rgba(59, 130, 246, 0.7),
                 0 0 60px rgba(96, 165, 250, 0.5),
                 0 0 85px rgba(147, 197, 253, 0.3),
                 0 0 100px rgba(191, 219, 254, 0.2);
    }
    .card-glow-green {
      box-shadow: 0 0 15px rgba(74, 222, 128, 0.2);
      transition: all 0.3s ease;
      will-change: box-shadow, transform;
    }
    .card-glow-green:hover {
      box-shadow: 0 0 25px rgba(74, 222, 128, 0.3);
    }
    .card-glow-cyan {
      box-shadow: 0 0 15px rgba(0, 188, 255, 0.2);
      transition: all 0.3s ease;
      will-change: box-shadow, transform;
    }
    .card-glow-cyan:hover {
      box-shadow: 0 0 25px rgba(0, 188, 255, 0.3);
    }
    .card-glow-purple {
      box-shadow: 0 0 15px rgba(167, 139, 250, 0.2);
      transition: all 0.3s ease;
      will-change: box-shadow, transform;
    }
    .card-glow-purple:hover {
      box-shadow: 0 0 25px rgba(167, 139, 250, 0.3);
    }
    @keyframes pulse {
      0% {
        filter: drop-shadow(0 0 15px rgba(59, 130, 246, 0.8))
               drop-shadow(0 0 25px rgba(59, 130, 246, 0.6))
               drop-shadow(0 0 35px rgba(96, 165, 250, 0.5));
      }
      50% {
        filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.9))
               drop-shadow(0 0 35px rgba(59, 130, 246, 0.7))
               drop-shadow(0 0 50px rgba(96, 165, 250, 0.6));
      }
      100% {
        filter: drop-shadow(0 0 15px rgba(59, 130, 246, 0.8))
               drop-shadow(0 0 25px rgba(59, 130, 246, 0.6))
               drop-shadow(0 0 35px rgba(96, 165, 250, 0.5));
      }
    }
    @keyframes cardPulse {
      0% {
        box-shadow: 0 0 25px rgba(59, 130, 246, 0.5),
                   0 0 40px rgba(96, 165, 250, 0.3),
                   0 0 60px rgba(147, 197, 253, 0.2);
      }
      50% {
        box-shadow: 0 0 30px rgba(59, 130, 246, 0.6),
                   0 0 50px rgba(96, 165, 250, 0.4),
                   0 0 70px rgba(147, 197, 253, 0.3);
      }
      100% {
        box-shadow: 0 0 25px rgba(59, 130, 246, 0.5),
                   0 0 40px rgba(96, 165, 250, 0.3),
                   0 0 60px rgba(147, 197, 253, 0.2);
      }
    }
    .box-hover {
      transition: all 0.3s ease-in-out;
      /* Add hardware acceleration */
      will-change: transform, background, box-shadow, border;
    }
    .box-hover:hover {
      transform: translateY(-10px);
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(12px);
    }
    .box-hover.blue:hover {
      box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.25),
                 0 0 25px -5px rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
    }
    .box-hover.green:hover {
      box-shadow: 0 20px 25px -5px rgba(74, 222, 128, 0.25),
                 0 0 25px -5px rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
    }
    .box-hover.cyan:hover {
      box-shadow: 0 20px 25px -5px rgba(0, 188, 255, 0.25),
                 0 0 25px -5px rgba(0, 188, 255, 0.1);
      border: 1px solid rgba(0, 188, 255, 0.3);
    }
    .box-hover.purple:hover {
      box-shadow: 0 20px 25px -5px rgba(167, 139, 250, 0.25),
                 0 0 25px -5px rgba(167, 139, 250, 0.1);
      border: 1px solid rgba(167, 139, 250, 0.3);
    }
    .dropdown-menu {
      transform-origin: top;
      transform: scaleY(0);
      opacity: 0;
      transition: all 0.2s ease-in-out;
      backdrop-filter: blur(12px);
      background: rgba(30, 41, 59, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      /* Add hardware acceleration */
      will-change: transform, opacity;
    }
    .dropdown:hover .dropdown-menu {
      transform: scaleY(1);
      opacity: 1;
    }
    .dropdown-item {
      transition: all 0.2s ease;
      will-change: background, padding-left;
    }
    .dropdown-item:hover {
      background: rgba(255, 255, 255, 0.1);
      padding-left: 1.5rem;
    }
    
    /* Add smooth loading animations */
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.5s ease-in forwards;
    }
    
    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }
    
    /* Preload keyframes */
    @keyframes preload {
      0% { opacity: 0; }
      100% { opacity: 0; }
    }
    
    /* Optimize grid loading */
    .grid-item {
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    .grid-item:nth-child(1) { animation-delay: 0.1s; }
    .grid-item:nth-child(2) { animation-delay: 0.2s; }
    .grid-item:nth-child(3) { animation-delay: 0.3s; }
    .grid-item:nth-child(4) { animation-delay: 0.4s; }
    .grid-item:nth-child(5) { animation-delay: 0.5s; }
    .grid-item:nth-child(6) { animation-delay: 0.6s; }
  </style>
</head>
<body class="min-h-screen flex flex-col" id="mainBody">

  <!-- Background with dotted grid -->
  <div class="absolute top-0 z-[-2] h-screen w-screen bg-[#000000] bg-[radial-gradient(#ffffff33_1px,#00091d_1px)] bg-[size:20px_20px]"></div>

  <!-- Security Icon at Top Center -->
  <div class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 fade-in">
    <a href="security-code.html">
      <img src="security-icon.jpg" alt="Security Icon" class="h-10 w-10 object-contain animate-pulse glow-effect-cyan" width="40" height="40" decoding="async" fetchpriority="high">
    </a>
  </div>

  <!-- Main Content Wrapper -->
  <div class="flex-1 flex items-center justify-center px-4 py-6 pt-12 md:pt-16">

  <main class="w-full max-w-2xl mx-auto grid grid-cols-2 md:grid-cols-3 gap-2">

    <!-- New Invoice Button -->
    <a href="select-invoice.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover blue">
      <!-- Invoice Icon Image -->
      <img src="invoice.png" alt="Invoice Icon" class="w-12 h-12 object-contain glow-effect-blue transform transition-transform duration-300 hover:scale-125" width="48" height="48" decoding="async" fetchpriority="high">
      <span class="text-sm font-medium text-slate-200">New Invoice</span>
    </a>

    <!-- Add Products Button -->
    <a href="add-products.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover green">
      <!-- Icon with Green Color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-green-400 glow-effect-green transform transition-transform duration-300 hover:scale-125" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
      </svg>
      <span class="text-sm font-medium text-slate-200">Add Products</span>
    </a>

    <!-- Products List Button -->
    <a href="product-list.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover purple">
      <!-- List Icon with Purple Color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-purple-400 glow-effect-purple transform transition-transform duration-300 hover:scale-125" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
      </svg>
      <span class="text-sm font-medium text-slate-200">Products List</span>
    </a>

    <!-- Invoice Software Button -->
    <a href="download-software.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover blue">
      <!-- Software Icon with Blue Color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-blue-400 glow-effect-blue transform transition-transform duration-300 hover:scale-125" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM13 12V8H11V12H8L12 16L16 12H13Z"/>
      </svg>
      <span class="text-sm font-medium text-slate-200">Invoice Software</span>
    </a>

    <!-- Invoice PDFs Button -->
    <a href="invoice-pdfs.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover purple">
      <!-- Document Icon with Purple Color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-purple-400 glow-effect-purple transform transition-transform duration-300 hover:scale-125" viewBox="0 0 24 24" fill="currentColor">
        <path d="M14 2H6C4.89 2 4 2.89 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V8L14 2M18 20H6V4H13V9H18V20M9 13V19H7V13H9M15 13V19H17V13H15M11 13V19H13V13H11Z"/>
      </svg>
      <span class="text-sm font-medium text-slate-200">Invoice PDFs</span>
    </a>

    <!-- Analytics Button -->
    <a href="analysis.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover green">
      <!-- Analytics Icon with Green Color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-green-400 glow-effect-green transform transition-transform duration-300 hover:scale-125" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3 13H5V19H3V13M7 9H9V19H7V9M11 5H13V19H11V5M15 9H17V19H15V9M19 13H21V19H19V13M2 21H22V23H2V21Z"/>
      </svg>
      <span class="text-sm font-medium text-slate-200">Analytics</span>
    </a>

    <!-- EMI Management Button -->
    <a href="emi-management.html" class="flex flex-col items-center space-y-2 p-4 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 box-hover cyan">
      <!-- EMI Icon with Cyan Color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-cyan-400 glow-effect-cyan transform transition-transform duration-300 hover:scale-125" viewBox="0 0 24 24" fill="currentColor">
        <path d="M21,18V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19A2,2 0 0,1 21,5V6H12C10.89,6 10,6.9 10,8V16A2,2 0 0,0 12,18H21M12,16H22V8H12V16M16,13.5A1.5,1.5 0 0,1 14.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,12A1.5,1.5 0 0,1 16,13.5Z" />
      </svg>
      <span class="text-sm font-medium text-slate-200">EMI Management</span>
    </a>

    </main>
  </div>

  <!-- Microphone Icon for Voice Command -->
  <div class="flex justify-center py-6">
    <button id="voiceCommandBtn" class="p-4 rounded-full bg-transparent hover:bg-transparent transition-all duration-300 cursor-pointer">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-orange-500" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2A3 3 0 0 0 9 5V11A3 3 0 0 0 15 11V5A3 3 0 0 0 12 2M19 11C19 14.53 16.39 17.44 13 17.93V21H11V17.93C7.61 17.44 5 14.53 5 11H7A5 5 0 0 1 12 16A5 5 0 0 1 17 11Z" />
      </svg>
    </button>
  </div>

  <!-- Footer -->
  <footer class="relative z-10 w-full mt-auto bg-[#000000] bg-[radial-gradient(#ffffff33_1px,#00091d_1px)] bg-[size:20px_20px]">
    <div class="relative z-10 text-center py-6 border-t border-white/5">
      <p class="text-gray-400">
        © <span id="current-year"></span> <span style="color: rgb(217, 119, 87);">Dastelecom</span>. All rights reserved.
      </p>
    </div>
  </footer>

  <script>
    // Set current year automatically
    document.getElementById('current-year').textContent = new Date().getFullYear();

    // Voice command functionality
    document.addEventListener('DOMContentLoaded', function() {
      const voiceBtn = document.getElementById('voiceCommandBtn');
      let recognition;
      let isListening = false;
      let currentStep = 'main'; // main, invoiceType
      let shouldListen = true;

      // Add visual indicator for debugging
      const micIcon = voiceBtn.querySelector('svg');
      
      // Check if browser supports speech recognition
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        // Initialize speech recognition
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.continuous = true;  // Always listening
        recognition.lang = 'en-US'; // Default language
        recognition.interimResults = false;
        recognition.maxAlternatives = 3; // Increase alternatives for better accuracy
        voiceBtn.addEventListener('click', function() {
          if (!recognition) return;
          if (shouldListen) {
            shouldListen = false;
            if (isListening) {
              try { recognition.stop(); } catch (e) {}
            }
          } else {
            shouldListen = true;
            if (!isListening) {
              try { recognition.start(); } catch (e) {}
            }
          }
        });

        recognition.onstart = function() {
          isListening = true;
          console.log('Voice recognition started - listening for commands...');
          micIcon.classList.add('animate-pulse');
          // Change color to indicate listening
          micIcon.style.filter = 'drop-shadow(0 0 8px rgba(255, 165, 0, 0.8))';
        };

        recognition.onresult = function(event) {
          // Process all results including interim results
          for (let i = event.resultIndex; i < event.results.length; i++) {
            const transcript = event.results[i][0].transcript.toLowerCase().trim();
            const rawTranscript = event.results[i][0].transcript;
            console.log('Voice command received:', transcript, 'isFinal:', event.results[i].isFinal);
            
            // Display recognized text for debugging
            console.log('Processing command:', transcript);
            
            // Main step - listening for "open invoice"
            if (currentStep === 'main') {
              let destination = null;
              let sayText = null;
              // Check for English phrases
              const openInvoicePhrases = [
                'open invoice',
                'open invoice form',
                'create invoice',
                'make invoice',
                'new invoice',
                'new bill'
              ];
              
              // Check for Bengali phrase
              const bengaliPhrase = 'নতুন বিল'; // "new bill/invoice" in Bengali
              
              let commandRecognized = false;
              let bnMatch = false;
              
              // Check English phrases
              for (const phrase of openInvoicePhrases) {
                if (transcript.includes(phrase)) {
                  commandRecognized = true;
                  destination = 'select-invoice.html';
                  sayText = 'Opening invoice';
                  console.log('Recognized command phrase:', phrase);
                  break;
                }
              }
              // Additional English intents
              if (!commandRecognized) {
                if (transcript.includes('add products') || transcript.includes('add product')) {
                  commandRecognized = true;
                  destination = 'add-products.html';
                  sayText = 'Opening add products';
                } else if (transcript.includes('product list') || transcript.includes('products list')) {
                  commandRecognized = true;
                  destination = 'product-list.html';
                  sayText = 'Opening products list';
                } else if (transcript.includes('invoice software') || transcript.includes('download software') || transcript.includes('software')) {
                  commandRecognized = true;
                  destination = 'download-software.html';
                  sayText = 'Opening invoice software';
                } else if (transcript.includes('invoice pdf') || transcript.includes('invoice pdfs') || transcript.includes('pdf')) {
                  commandRecognized = true;
                  destination = 'invoice-pdfs.html';
                  sayText = 'Opening invoice PDFs';
                } else if (transcript.includes('analytics') || transcript.includes('analysis')) {
                  commandRecognized = true;
                  destination = 'analysis.html';
                  sayText = 'Opening analytics';
                } else if (transcript.includes('emi management') || transcript.includes('emi')) {
                  commandRecognized = true;
                  destination = 'emi-management.html';
                  sayText = 'Opening EMI management';
                } else if (transcript.includes('security code') || transcript.includes('security')) {
                  commandRecognized = true;
                  destination = 'security-code.html';
                  sayText = 'Opening security code';
                }
              }
              // Check Bengali phrase (keep original case for Unicode text)
              if (!commandRecognized && (event.results[i][0].transcript.includes(bengaliPhrase) || event.results[i][0].transcript.includes('নতুন ইনভয়েস') || event.results[i][0].transcript.includes('নতুন ইনভয়েস'))) {
                commandRecognized = true;
                bnMatch = true;
                destination = 'select-invoice.html';
                sayText = 'ওপেন করছি ইনভয়েস';
                console.log('Recognized Bengali command phrase:', bengaliPhrase);
              }
              // Additional Bengali intents
              if (!commandRecognized) {
                if (rawTranscript.includes('প্রোডাক্ট') || rawTranscript.includes('পণ্য')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'add-products.html';
                  sayText = 'প্রোডাক্ট যোগ পৃষ্ঠা খুলছি';
                } else if (rawTranscript.includes('তালিকা') || rawTranscript.includes('লিস্ট')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'product-list.html';
                  sayText = 'প্রোডাক্ট তালিকা খুলছি';
                } else if (rawTranscript.includes('সফটওয়্যার') || rawTranscript.includes('ডাউনলোড')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'download-software.html';
                  sayText = 'সফটওয়্যার পৃষ্ঠা খুলছি';
                } else if (rawTranscript.includes('পিডিএফ')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'invoice-pdfs.html';
                  sayText = 'ইনভয়েস পিডিএফ খুলছি';
                } else if (rawTranscript.includes('বিশ্লেষণ')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'analysis.html';
                  sayText = 'অ্যানালিটিক্স খুলছি';
                } else if (rawTranscript.includes('ই এম আই') || rawTranscript.includes('ইএমআই')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'emi-management.html';
                  sayText = 'ই এম আই ম্যানেজমেন্ট খুলছি';
                } else if (rawTranscript.includes('সিকিউরিটি')) {
                  commandRecognized = true; bnMatch = true;
                  destination = 'security-code.html';
                  sayText = 'সিকিউরিটি কোড খুলছি';
                }
              }
              // Only act on final results to prevent premature navigation
              if (commandRecognized && event.results[i].isFinal) {
                console.log('Redirecting to', destination || 'select-invoice.html');
                // Add visual feedback
                micIcon.style.filter = 'drop-shadow(0 0 12px rgba(0, 255, 0, 0.8))';
                
                // Speak a short "Opening ..." then redirect
                if ('speechSynthesis' in window) {
                  const utterance = new SpeechSynthesisUtterance(sayText || (bnMatch ? 'ওপেন করছি' : 'Opening'));
                  utterance.lang = bnMatch ? 'bn-IN' : 'en-US';
                  utterance.rate = 1.0;
                  utterance.pitch = 1.0;
                  speechSynthesis.speak(utterance);
                  // Redirect after a brief delay
                  setTimeout(() => {
                    window.location.href = destination || 'select-invoice.html';
                  }, 900);
                } else {
                  // Fallback: redirect immediately if speech synthesis is not supported
                  window.location.href = destination || 'select-invoice.html';
                }
                return;
              } else if (commandRecognized && !event.results[i].isFinal) {
                // Visual feedback for interim recognition
                micIcon.style.filter = 'drop-shadow(0 0 12px rgba(0, 191, 255, 0.8))'; // Light blue for interim
                setTimeout(() => {
                  if (isListening) {
                    micIcon.style.filter = 'drop-shadow(0 0 8px rgba(255, 165, 0, 0.8))';
                  }
                }, 300);
              } else if (!commandRecognized && event.results[i].isFinal) {
                console.log('Command not recognized. Try saying "open invoice" or "নতুন বিল"');
                // Visual feedback for unrecognized command
                micIcon.style.filter = 'drop-shadow(0 0 12px rgba(255, 0, 0, 0.8))';
                setTimeout(() => {
                  if (isListening) {
                    micIcon.style.filter = 'drop-shadow(0 0 8px rgba(255, 165, 0, 0.8))';
                  }
                }, 1000);
              }
            }
          }
        };

        recognition.onerror = function(event) {
          isListening = false;
          console.error('Speech recognition error:', event.error);
          console.error('Error details:', event);
          // Visual feedback for error
          micIcon.style.filter = 'drop-shadow(0 0 12px rgba(255, 0, 0, 0.8))';
          
          // Try switching to Bengali language if English fails
          if (recognition.lang === 'en-US') {
            recognition.lang = 'bn-IN';
            console.log('Switching to Bengali language recognition');
          } else {
            recognition.lang = 'en-US'; // Switch back to English
            console.log('Switching back to English language recognition');
          }
          
          // Restart recognition after error
          setTimeout(() => {
            if (shouldListen && !isListening) {
              try {
                recognition.start();
                console.log('Attempting to restart recognition...');
              } catch (e) {
                console.error('Error restarting recognition:', e);
              }
            }
          }, 3000);
        };

        recognition.onend = function() {
          isListening = false;
          console.log('Speech recognition ended');
          micIcon.classList.remove('animate-pulse');
          micIcon.style.filter = 'none';
          
          // Restart recognition when it stops
          setTimeout(() => {
            if (shouldListen && !isListening) {
              try {
                recognition.start();
                console.log('Restarting recognition...');
              } catch (e) {
                console.error('Error restarting recognition:', e);
              }
            }
          }, 1500);
        };

        // Start recognition automatically when page loads
        setTimeout(() => {
          try {
            if (shouldListen) {
              recognition.start();
              console.log('Voice recognition initialized with language:', recognition.lang);
            }
          } catch (error) {
            console.error('Error starting voice recognition:', error);
            // Visual feedback for error
            micIcon.style.filter = 'drop-shadow(0 0 12px rgba(255, 0, 0, 0.8))';
          }
        }, 1500);
      } else {
        // Hide the button if speech recognition is not supported
        voiceBtn.style.display = 'none';
        console.log('Speech recognition not supported in this browser');
      }
    });
  </script>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker
      .register('/service-worker.js')
      .then(() => console.log('Service Worker Registered'))
      .catch((err) => console.log('Service Worker registration failed:', err));
  }
</script>

</body>
</html>
